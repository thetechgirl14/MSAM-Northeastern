function Qij = jacobi_rotation(A, i, j)
  
    n = size(A, 1);
    
    Qij = eye(n);
    
    if A(i, j) ~= 0
        tau = (A(j, j) - A(i, i)) / (2 * A(i, j));
        t = - tau - sqrt(tau^2 + 1);
        c = sqrt((1 - t)^2 / (1 + t)^2 *(A(i,i)- t^2 *A(j,j)));
        %c = 1 / sqrt(1 + t^2);
        s = A(i,j)*c/A(i,i);
        %disp(c^2 + s^2)
    else
        c = 1;
        s = 0;
    end
    
    Qij(i, i) = c;
    Qij(j, j) = c;
    Qij(i, j) = -s;
    Qij(j, i) = s;

end
